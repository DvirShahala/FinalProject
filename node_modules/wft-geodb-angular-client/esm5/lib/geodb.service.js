/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { HttpClient, HttpParams } from '@angular/common/http';
import { Injectable } from '@angular/core';
import { GeoDbConfig } from './model/geodb-config.model';
var GeoDbService = /** @class */ (function () {
    function GeoDbService(httpClient, config) {
        this.httpClient = httpClient;
        this.config = config;
        this.adminDivisionsEndpoint = config.serviceUri + 'v1/geo/adminDivisions';
        this.countriesEndpoint = config.serviceUri + '/v1/geo/countries';
        this.currenciesEndpoint = config.serviceUri + '/v1/locale/currencies';
        this.languagesEndpoint = config.serviceUri + '/v1/locale/languages';
        this.localesEndpoint = config.serviceUri + '/v1/locale/locales';
        this.placesEndpoint = config.serviceUri + '/v1/geo/cities';
        this.timeZonesEndpoint = config.serviceUri + '/v1/locale/timezones';
    }
    /**
     * @private
     * @param {?} request
     * @return {?}
     */
    GeoDbService.buildPagingParams = /**
     * @private
     * @param {?} request
     * @return {?}
     */
    function (request) {
        return new HttpParams()
            .set('offset', '' + request.offset)
            .set('limit', '' + request.limit)
            .set('hateoasMode', 'false');
    };
    /**
     * @private
     * @param {?} nearLocation
     * @return {?}
     */
    GeoDbService.toLocationString = /**
     * @private
     * @param {?} nearLocation
     * @return {?}
     */
    function (nearLocation) {
        /** @type {?} */
        var locationString = '';
        if (nearLocation.latitude > 0) {
            locationString += '+';
        }
        locationString += nearLocation.latitude;
        if (nearLocation.longitude > 0) {
            locationString += '+';
        }
        locationString += nearLocation.longitude;
        return locationString;
    };
    /**
     * @param {?} request
     * @return {?}
     */
    GeoDbService.prototype.findAdminDivisions = /**
     * @param {?} request
     * @return {?}
     */
    function (request) {
        /** @type {?} */
        var params = GeoDbService.buildPagingParams(request);
        if (request.countryIds) {
            params = params.set('countryIds', request.countryIds.join(','));
        }
        if (request.excludedCountryIds) {
            params = params.set('excludedCountryIds', request.excludedCountryIds.join(','));
        }
        if (request.namePrefix) {
            params = params.set('namePrefix', request.namePrefix);
        }
        if (request.minPopulation) {
            params = params.set('minPopulation', '' + request.minPopulation);
        }
        if (request.timeZoneIds) {
            params = params.set('timeZoneIds', request.timeZoneIds.join(','));
        }
        if (request.asciiMode) {
            params = params.set('asciiMode', '' + request.asciiMode);
        }
        if (request.languageCode) {
            params = params.set('languageCode', request.languageCode);
        }
        if (request.sortDirectives) {
            params = params.set('sort', request.sortDirectives.join(','));
        }
        if (request.includeDeleted) {
            params = params.set('includeDeleted', request.includeDeleted);
        }
        return this.httpClient.get(this.adminDivisionsEndpoint, {
            params: params
        });
    };
    /**
     * @param {?} request
     * @return {?}
     */
    GeoDbService.prototype.findPlace = /**
     * @param {?} request
     * @return {?}
     */
    function (request) {
        /** @type {?} */
        var endpoint = this.buildPlaceEndpoint(request.placeId);
        /** @type {?} */
        var params = new HttpParams();
        if (request.asciiMode) {
            params = params.set('asciiMode', '' + request.asciiMode);
        }
        if (request.languageCode) {
            params = params.set('languageCode', request.languageCode);
        }
        return this.httpClient.get(endpoint, {
            params: params
        });
    };
    /**
     * @param {?} request
     * @return {?}
     */
    GeoDbService.prototype.findPlaces = /**
     * @param {?} request
     * @return {?}
     */
    function (request) {
        /** @type {?} */
        var params = GeoDbService.buildPagingParams(request);
        if (request.countryIds) {
            params = params.set('countryIds', request.countryIds.join(','));
        }
        if (request.excludedCountryIds) {
            params = params.set('excludedCountryIds', request.excludedCountryIds.join(','));
        }
        if (request.namePrefix) {
            params = params.set('namePrefix', request.namePrefix);
        }
        if (request.minPopulation) {
            params = params.set('minPopulation', '' + request.minPopulation);
        }
        if (request.timeZoneIds) {
            params = params.set('timeZoneIds', request.timeZoneIds.join(','));
        }
        if (request.types) {
            params = params.set('types', request.types.join(','));
        }
        if (request.asciiMode) {
            params = params.set('asciiMode', '' + request.asciiMode);
        }
        if (request.languageCode) {
            params = params.set('languageCode', request.languageCode);
        }
        if (request.sortDirectives) {
            params = params.set('sort', request.sortDirectives.join(','));
        }
        if (request.includeDeleted) {
            params = params.set('includeDeleted', request.includeDeleted);
        }
        return this.httpClient.get(this.placesEndpoint, {
            params: params
        });
    };
    /**
     * @param {?} request
     * @return {?}
     */
    GeoDbService.prototype.findPlacesNearLocation = /**
     * @param {?} request
     * @return {?}
     */
    function (request) {
        /** @type {?} */
        var params = GeoDbService.buildPagingParams(request);
        params = params
            .set('radius', '' + request.location.radius)
            .set('distanceUnit', request.location.distanceUnit);
        if (request.minPopulation) {
            params = params.set('minPopulation', '' + request.minPopulation);
        }
        if (request.namePrefix) {
            params = params.set('namePrefix', request.namePrefix);
        }
        if (request.types) {
            params = params.set('types', request.types.join(','));
        }
        if (request.asciiMode) {
            params = params.set('asciiMode', '' + request.asciiMode);
        }
        if (request.languageCode) {
            params = params.set('languageCode', request.languageCode);
        }
        if (request.sortDirectives) {
            params = params.set('sort', request.sortDirectives.join(','));
        }
        if (request.includeDeleted) {
            params = params.set('includeDeleted', request.includeDeleted);
        }
        // Workaround for HttpClient '+' encoding bug.
        /** @type {?} */
        var locationId = GeoDbService
            .toLocationString(request.location)
            .replace('+', '%2B');
        /** @type {?} */
        var endpoint = this.placesEndpoint + '?location=' + locationId;
        return this.httpClient.get(endpoint, {
            params: params
        });
    };
    /**
     * @param {?} request
     * @return {?}
     */
    GeoDbService.prototype.findPlacesNearPlace = /**
     * @param {?} request
     * @return {?}
     */
    function (request) {
        /** @type {?} */
        var params = GeoDbService.buildPagingParams(request);
        params = params
            .set('radius', '' + request.radius)
            .set('distanceUnit', request.distanceUnit);
        if (request.minPopulation) {
            params = params.set('minPopulation', '' + request.minPopulation);
        }
        if (request.types) {
            params = params.set('types', request.types.join(','));
        }
        if (request.asciiMode) {
            params = params.set('asciiMode', '' + request.asciiMode);
        }
        if (request.languageCode) {
            params = params.set('languageCode', request.languageCode);
        }
        if (request.sortDirectives) {
            params = params.set('sort', request.sortDirectives.join(','));
        }
        if (request.includeDeleted) {
            params = params.set('includeDeleted', request.includeDeleted);
        }
        /** @type {?} */
        var endpoint = this.placesEndpoint + '/' + request.placeId + '/nearbyCities';
        return this.httpClient.get(endpoint, {
            params: params
        });
    };
    /**
     * @param {?} request
     * @return {?}
     */
    GeoDbService.prototype.findCountries = /**
     * @param {?} request
     * @return {?}
     */
    function (request) {
        /** @type {?} */
        var params = GeoDbService.buildPagingParams(request);
        if (request.currencyCode) {
            params = params.set('currencyCode', request.currencyCode);
        }
        if (request.namePrefix) {
            params = params.set('namePrefix', request.namePrefix);
        }
        if (request.asciiMode) {
            params = params.set('asciiMode', '' + request.asciiMode);
        }
        if (request.languageCode) {
            params = params.set('languageCode', request.languageCode);
        }
        return this.httpClient.get(this.countriesEndpoint, {
            params: params
        });
    };
    /**
     * @param {?} request
     * @return {?}
     */
    GeoDbService.prototype.findCountry = /**
     * @param {?} request
     * @return {?}
     */
    function (request) {
        /** @type {?} */
        var endpoint = this.countriesEndpoint + '/' + request.countryId;
        /** @type {?} */
        var params = new HttpParams();
        if (request.asciiMode) {
            params = params.set('asciiMode', '' + request.asciiMode);
        }
        if (request.languageCode) {
            params = params.set('languageCode', request.languageCode);
        }
        return this.httpClient.get(endpoint, {
            params: params
        });
    };
    /**
     * @param {?} request
     * @return {?}
     */
    GeoDbService.prototype.findCurrencies = /**
     * @param {?} request
     * @return {?}
     */
    function (request) {
        /** @type {?} */
        var params = GeoDbService.buildPagingParams(request);
        if (request.countryId) {
            params = params.set('countryId', request.countryId);
        }
        return this.httpClient.get(this.currenciesEndpoint, {
            params: params
        });
    };
    /**
     * @param {?} request
     * @return {?}
     */
    GeoDbService.prototype.findLanguages = /**
     * @param {?} request
     * @return {?}
     */
    function (request) {
        /** @type {?} */
        var params = GeoDbService.buildPagingParams(request);
        return this.httpClient.get(this.languagesEndpoint, {
            params: params
        });
    };
    /**
     * @param {?} request
     * @return {?}
     */
    GeoDbService.prototype.findLocales = /**
     * @param {?} request
     * @return {?}
     */
    function (request) {
        /** @type {?} */
        var params = GeoDbService.buildPagingParams(request);
        return this.httpClient.get(this.localesEndpoint, {
            params: params
        });
    };
    /**
     * @param {?} request
     * @return {?}
     */
    GeoDbService.prototype.findRegion = /**
     * @param {?} request
     * @return {?}
     */
    function (request) {
        /** @type {?} */
        var endpoint = this.buildRegionsEndpoint(request.countryId) + '/' + request.regionCode;
        /** @type {?} */
        var params = new HttpParams();
        if (request.asciiMode) {
            params = params.set('asciiMode', '' + request.asciiMode);
        }
        if (request.languageCode) {
            params = params.set('languageCode', request.languageCode);
        }
        return this.httpClient.get(endpoint, {
            params: params
        });
    };
    /**
     * @param {?} request
     * @return {?}
     */
    GeoDbService.prototype.findRegionPlaces = /**
     * @param {?} request
     * @return {?}
     */
    function (request) {
        /** @type {?} */
        var endpoint = this.buildRegionEndpoint(request.countryId, request.regionCode) + '/cities';
        /** @type {?} */
        var params = GeoDbService.buildPagingParams(request);
        if (request.minPopulation) {
            params = params.set('minPopulation', '' + request.minPopulation);
        }
        if (request.types) {
            params = params.set('types', request.types.join(','));
        }
        if (request.asciiMode) {
            params = params.set('asciiMode', '' + request.asciiMode);
        }
        if (request.languageCode) {
            params = params.set('languageCode', request.languageCode);
        }
        if (request.sortDirectives) {
            params = params.set('sort', request.sortDirectives.join(','));
        }
        return this.httpClient.get(endpoint, {
            params: params
        });
    };
    /**
     * @param {?} request
     * @return {?}
     */
    GeoDbService.prototype.findRegions = /**
     * @param {?} request
     * @return {?}
     */
    function (request) {
        /** @type {?} */
        var endpoint = this.buildRegionsEndpoint(request.countryId);
        /** @type {?} */
        var params = GeoDbService.buildPagingParams(request);
        if (request.namePrefix) {
            params = params.set('namePrefix', request.namePrefix);
        }
        if (request.asciiMode) {
            params = params.set('asciiMode', '' + request.asciiMode);
        }
        if (request.languageCode) {
            params = params.set('languageCode', request.languageCode);
        }
        return this.httpClient.get(endpoint, {
            params: params
        });
    };
    /**
     * @param {?} request
     * @return {?}
     */
    GeoDbService.prototype.findTimeZones = /**
     * @param {?} request
     * @return {?}
     */
    function (request) {
        /** @type {?} */
        var params = GeoDbService.buildPagingParams(request);
        return this.httpClient.get(this.timeZonesEndpoint, {
            params: params
        });
    };
    Object.defineProperty(GeoDbService.prototype, "apiKey", {
        get: /**
         * @return {?}
         */
        function () {
            return this.config.apiKey;
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @param {?} apiKey
     * @return {?}
     */
    GeoDbService.prototype.setApiKey = /**
     * @param {?} apiKey
     * @return {?}
     */
    function (apiKey) {
        this.config.apiKey = apiKey;
    };
    /**
     * @param {?} id
     * @return {?}
     */
    GeoDbService.prototype.getPlaceDateTime = /**
     * @param {?} id
     * @return {?}
     */
    function (id) {
        /** @type {?} */
        var endpoint = this.buildPlaceEndpoint(id) + '/dateTime';
        return this.httpClient.get(endpoint);
    };
    /**
     * @param {?} request
     * @return {?}
     */
    GeoDbService.prototype.getPlaceDistance = /**
     * @param {?} request
     * @return {?}
     */
    function (request) {
        /** @type {?} */
        var endpoint = this.buildPlaceEndpoint(request.toPlaceId) + '/distance';
        /** @type {?} */
        var params = new HttpParams()
            .set('fromPlaceId', '' + request.fromPlaceId)
            .set('distanceUnit', '' + request.distanceUnit);
        return this.httpClient.get(endpoint, {
            params: params
        });
    };
    /**
     * @param {?} placeId
     * @return {?}
     */
    GeoDbService.prototype.getPlaceTime = /**
     * @param {?} placeId
     * @return {?}
     */
    function (placeId) {
        /** @type {?} */
        var endpoint = this.buildPlaceEndpoint(placeId) + '/time';
        return this.httpClient.get(endpoint);
    };
    /**
     * @param {?} zoneId
     * @return {?}
     */
    GeoDbService.prototype.getTimeZoneDateTime = /**
     * @param {?} zoneId
     * @return {?}
     */
    function (zoneId) {
        /** @type {?} */
        var endpoint = this.buildTimeZoneEndpoint(zoneId) + '/dateTime';
        return this.httpClient.get(endpoint);
    };
    /**
     * @param {?} zoneId
     * @return {?}
     */
    GeoDbService.prototype.getTimeZoneTime = /**
     * @param {?} zoneId
     * @return {?}
     */
    function (zoneId) {
        /** @type {?} */
        var endpoint = this.buildTimeZoneEndpoint(zoneId) + '/time';
        return this.httpClient.get(endpoint);
    };
    /**
     * @private
     * @param {?} olaceId
     * @return {?}
     */
    GeoDbService.prototype.buildPlaceEndpoint = /**
     * @private
     * @param {?} olaceId
     * @return {?}
     */
    function (olaceId) {
        return this.placesEndpoint + '/' + olaceId;
    };
    /**
     * @private
     * @param {?} countryId
     * @param {?} regionCode
     * @return {?}
     */
    GeoDbService.prototype.buildRegionEndpoint = /**
     * @private
     * @param {?} countryId
     * @param {?} regionCode
     * @return {?}
     */
    function (countryId, regionCode) {
        return this.buildRegionsEndpoint(countryId) + '/' + regionCode;
    };
    /**
     * @private
     * @param {?} countryId
     * @return {?}
     */
    GeoDbService.prototype.buildRegionsEndpoint = /**
     * @private
     * @param {?} countryId
     * @return {?}
     */
    function (countryId) {
        return this.countriesEndpoint + '/' + countryId + '/regions';
    };
    /**
     * @private
     * @param {?} zoneId
     * @return {?}
     */
    GeoDbService.prototype.buildTimeZoneEndpoint = /**
     * @private
     * @param {?} zoneId
     * @return {?}
     */
    function (zoneId) {
        return this.timeZonesEndpoint + '/' + zoneId;
    };
    GeoDbService.decorators = [
        { type: Injectable }
    ];
    /** @nocollapse */
    GeoDbService.ctorParameters = function () { return [
        { type: HttpClient },
        { type: GeoDbConfig }
    ]; };
    return GeoDbService;
}());
export { GeoDbService };
if (false) {
    /**
     * @type {?}
     * @private
     */
    GeoDbService.prototype.adminDivisionsEndpoint;
    /**
     * @type {?}
     * @private
     */
    GeoDbService.prototype.countriesEndpoint;
    /**
     * @type {?}
     * @private
     */
    GeoDbService.prototype.currenciesEndpoint;
    /**
     * @type {?}
     * @private
     */
    GeoDbService.prototype.languagesEndpoint;
    /**
     * @type {?}
     * @private
     */
    GeoDbService.prototype.localesEndpoint;
    /**
     * @type {?}
     * @private
     */
    GeoDbService.prototype.placesEndpoint;
    /**
     * @type {?}
     * @private
     */
    GeoDbService.prototype.timeZonesEndpoint;
    /**
     * @type {?}
     * @private
     */
    GeoDbService.prototype.httpClient;
    /**
     * @type {?}
     * @private
     */
    GeoDbService.prototype.config;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZ2VvZGIuc2VydmljZS5qcyIsInNvdXJjZVJvb3QiOiJuZzovL3dmdC1nZW9kYi1hbmd1bGFyLWNsaWVudC8iLCJzb3VyY2VzIjpbImxpYi9nZW9kYi5zZXJ2aWNlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7QUFFQSxPQUFPLEVBQUMsVUFBVSxFQUFFLFVBQVUsRUFBQyxNQUFNLHNCQUFzQixDQUFDO0FBQzVELE9BQU8sRUFBQyxVQUFVLEVBQUMsTUFBTSxlQUFlLENBQUM7QUFTekMsT0FBTyxFQUFDLFdBQVcsRUFBQyxNQUFNLDRCQUE0QixDQUFDO0FBcUJ2RDtJQVVFLHNCQUFvQixVQUFzQixFQUFVLE1BQW1CO1FBQW5ELGVBQVUsR0FBVixVQUFVLENBQVk7UUFBVSxXQUFNLEdBQU4sTUFBTSxDQUFhO1FBRXJFLElBQUksQ0FBQyxzQkFBc0IsR0FBRyxNQUFNLENBQUMsVUFBVSxHQUFHLHVCQUF1QixDQUFDO1FBQzFFLElBQUksQ0FBQyxpQkFBaUIsR0FBRyxNQUFNLENBQUMsVUFBVSxHQUFHLG1CQUFtQixDQUFDO1FBQ2pFLElBQUksQ0FBQyxrQkFBa0IsR0FBRyxNQUFNLENBQUMsVUFBVSxHQUFHLHVCQUF1QixDQUFDO1FBQ3RFLElBQUksQ0FBQyxpQkFBaUIsR0FBRyxNQUFNLENBQUMsVUFBVSxHQUFHLHNCQUFzQixDQUFDO1FBQ3BFLElBQUksQ0FBQyxlQUFlLEdBQUcsTUFBTSxDQUFDLFVBQVUsR0FBRyxvQkFBb0IsQ0FBQztRQUNoRSxJQUFJLENBQUMsY0FBYyxHQUFHLE1BQU0sQ0FBQyxVQUFVLEdBQUcsZ0JBQWdCLENBQUM7UUFDM0QsSUFBSSxDQUFDLGlCQUFpQixHQUFHLE1BQU0sQ0FBQyxVQUFVLEdBQUcsc0JBQXNCLENBQUM7SUFDdEUsQ0FBQzs7Ozs7O0lBRWMsOEJBQWlCOzs7OztJQUFoQyxVQUFpQyxPQUE4QjtRQUU3RCxPQUFPLElBQUksVUFBVSxFQUFFO2FBQ3BCLEdBQUcsQ0FBQyxRQUFRLEVBQUUsRUFBRSxHQUFHLE9B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QUUsOEJBQTJCIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtPYnNlcnZhYmxlfSBmcm9tICdyeGpzJztcblxuaW1wb3J0IHtIdHRwQ2xpZW50LCBIdHRwUGFyYW1zfSBmcm9tICdAYW5ndWxhci9jb21tb24vaHR0cCc7XG5pbXBvcnQge0luamVjdGFibGV9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuXG5pbXBvcnQge1BsYWNlRGV0YWlsc30gZnJvbSAnLi9tb2RlbC9wbGFjZS1kZXRhaWxzLm1vZGVsJztcbmltcG9ydCB7UGxhY2VTdW1tYXJ5fSBmcm9tICcuL21vZGVsL3BsYWNlLXN1bW1hcnkubW9kZWwnO1xuaW1wb3J0IHtDb3VudHJ5U3VtbWFyeX0gZnJvbSAnLi9tb2RlbC9jb3VudHJ5LXN1bW1hcnkubW9kZWwnO1xuaW1wb3J0IHtHZW9SZXNwb25zZX0gZnJvbSAnLi9tb2RlbC9nZW8tcmVzcG9uc2UubW9kZWwnO1xuaW1wb3J0IHtOZWFyTG9jYXRpb25SZXF1ZXN0fSBmcm9tICcuL3JlcXVlc3QvbmVhci1sb2NhdGlvbi1yZXF1ZXN0Lm1vZGVsJztcbmltcG9ydCB7UmVnaW9uU3VtbWFyeX0gZnJvbSAnLi9tb2RlbC9yZWdpb24tc3VtbWFyeS5tb2RlbCc7XG5cbmltcG9ydCB7R2VvRGJDb25maWd9IGZyb20gJy4vbW9kZWwvZ2VvZGItY29uZmlnLm1vZGVsJztcbmltcG9ydCB7Q291bnRyeURldGFpbHN9IGZyb20gJy4vbW9kZWwvY291bnRyeS1kZXRhaWxzLm1vZGVsJztcbmltcG9ydCB7UmVnaW9uRGV0YWlsc30gZnJvbSAnLi9tb2RlbC9yZWdpb24tZGV0YWlscy5tb2RlbCc7XG5pbXBvcnQge0N1cnJlbmN5fSBmcm9tICcuL21vZGVsL2N1cnJlbmN5Lm1vZGVsJztcbmltcG9ydCB7TG9jYWxlfSBmcm9tICcuL21vZGVsL2xvY2FsZS5tb2RlbCc7XG5pbXBvcnQge0ZpbmRBZG1pbkRpdmlzaW9uc1JlcXVlc3R9IGZyb20gJy4vcmVxdWVzdC9maW5kLWFkbWluLWRpdmlzaW9ucy1yZXF1ZXN0Lm1vZGVsJztcbmltcG9ydCB7RmluZFBsYWNlc1JlcXVlc3R9IGZyb20gJy4vcmVxdWVzdC9maW5kLXBsYWNlcy1yZXF1ZXN0Lm1vZGVsJztcbmltcG9ydCB7RmluZENvbGxlY3Rpb25SZXF1ZXN0fSBmcm9tICcuL3JlcXVlc3QvZmluZC1jb2xsZWN0aW9uLXJlcXVlc3QubW9kZWwnO1xuaW1wb3J0IHtGaW5kQ291bnRyaWVzUmVxdWVzdH0gZnJvbSAnLi9yZXF1ZXN0L2ZpbmQtY291bnRyaWVzLXJlcXVlc3QubW9kZWwnO1xuaW1wb3J0IHtGaW5kQ3VycmVuY2llc1JlcXVlc3R9IGZyb20gJy4vcmVxdWVzdC9maW5kLWN1cnJlbmNpZXMtcmVxdWVzdC5tb2RlbCc7XG5pbXBvcnQge0ZpbmRSZWdpb25zUmVxdWVzdH0gZnJvbSAnLi9yZXF1ZXN0L2ZpbmQtcmVnaW9ucy1yZXF1ZXN0Lm1vZGVsJztcbmltcG9ydCB7RmluZFJlZ2lvbkNpdGllc1JlcXVlc3R9IGZyb20gJy4vcmVxdWVzdC9maW5kLXJlZ2lvbi1jaXRpZXMtcmVxdWVzdC5tb2RlbCc7XG5pbXBvcnQge0ZpbmRQbGFjZXNOZWFyUGxhY2VSZXF1ZXN0fSBmcm9tICcuL3JlcXVlc3QvZmluZC1wbGFjZXMtbmVhci1wbGFjZS1yZXF1ZXN0Lm1vZGVsJztcbmltcG9ydCB7VGltZVpvbmV9IGZyb20gJy4vbW9kZWwvdGltZS16b25lLm1vZGVsJztcbmltcG9ydCB7R2V0UGxhY2VEaXN0YW5jZVJlcXVlc3R9IGZyb20gJy4vcmVxdWVzdC9nZXQtcGxhY2UtZGlzdGFuY2UtcmVxdWVzdC5tb2RlbCc7XG5pbXBvcnQge0ZpbmRQbGFjZXNOZWFyTG9jYXRpb25SZXF1ZXN0fSBmcm9tICcuL3JlcXVlc3QvZmluZC1wbGFjZXMtbmVhci1sb2NhdGlvbi1yZXF1ZXN0Lm1vZGVsJztcbmltcG9ydCB7R2V0UGxhY2VEZXRhaWxzUmVxdWVzdH0gZnJvbSAnLi9yZXF1ZXN0L2dldC1wbGFjZS1kZXRhaWxzLXJlcXVlc3QubW9kZWwnO1xuaW1wb3J0IHtHZXRDb3VudHJ5RGV0YWlsc1JlcXVlc3R9IGZyb20gJy4vcmVxdWVzdC9nZXQtY291bnRyeS1kZXRhaWxzLXJlcXVlc3QubW9kZWwnO1xuaW1wb3J0IHtHZXRSZWdpb25EZXRhaWxzUmVxdWVzdH0gZnJvbSAnLi9yZXF1ZXN0L2dldC1yZWdpb24tZGV0YWlscy1yZXF1ZXN0Lm1vZGVsJztcbmltcG9ydCB7TGFuZ3VhZ2V9IGZyb20gJy4vbW9kZWwvbGFuZ3VhZ2UubW9kZWwnO1xuXG5ASW5qZWN0YWJsZSgpXG5leHBvcnQgY2xhc3MgR2VvRGJTZXJ2aWNlIHtcbiAgcHJpdmF0ZSBhZG1pbkRpdmlzaW9uc0VuZHBvaW50OiBzdHJpbmc7XG4gIHByaXZhdGUgY291bnRyaWVzRW5kcG9pbnQ6IHN0cmluZztcbiAgcHJpdmF0ZSBjdXJyZW5jaWVzRW5kcG9pbnQ6IHN0cmluZztcbiAgcHJpdmF0ZSBsYW5ndWFnZXNFbmRwb2ludDogc3RyaW5nO1xuICBwcml2YXRlIGxvY2FsZXNFbmRwb2ludDogc3RyaW5nO1xuICBwcml2YXRlIHBsYWNlc0VuZHBvaW50OiBzdHJpbmc7XG4gIHByaXZhdGUgdGltZVpvbmVzRW5kcG9pbnQ6IHN0cmluZztcblxuICBjb25zdHJ1Y3Rvcihwcml2YXRlIGh0dHBDbGllbnQ6IEh0dHBDbGllbnQsIHByaXZhdGUgY29uZmlnOiBHZW9EYkNvbmZpZykge1xuXG4gICAgdGhpcy5hZG1pbkRpdmlzaW9uc0VuZHBvaW50ID0gY29uZmlnLnNlcnZpY2VVcmkgKyAndjEvZ2VvL2FkbWluRGl2aXNpb25zJztcbiAgICB0aGlzLmNvdW50cmllc0VuZHBvaW50ID0gY29uZmlnLnNlcnZpY2VVcmkgKyAnL3YxL2dlby9jb3VudHJpZXMnO1xuICAgIHRoaXMuY3VycmVuY2llc0VuZHBvaW50ID0gY29uZmlnLnNlcnZpY2VVcmkgKyAnL3YxL2xvY2FsZS9jdXJyZW5jaWVzJztcbiAgICB0aGlzLmxhbmd1YWdlc0VuZHBvaW50ID0gY29uZmlnLnNlcnZpY2VVcmkgKyAnL3YxL2xvY2FsZS9sYW5ndWFnZXMnO1xuICAgIHRoaXMubG9jYWxlc0VuZHBvaW50ID0gY29uZmlnLnNlcnZpY2VVcmkgKyAnL3YxL2xvY2FsZS9sb2NhbGVzJztcbiAgICB0aGlzLnBsYWNlc0VuZHBvaW50ID0gY29uZmlnLnNlcnZpY2VVcmkgKyAnL3YxL2dlby9jaXRpZXMnO1xuICAgIHRoaXMudGltZVpvbmVzRW5kcG9pbnQgPSBjb25maWcuc2VydmljZVVyaSArICcvdjEvbG9jYWxlL3RpbWV6b25lcyc7XG4gIH1cblxuICBwcml2YXRlIHN0YXRpYyBidWlsZFBhZ2luZ1BhcmFtcyhyZXF1ZXN0OiBGaW5kQ29sbGVjdGlvblJlcXVlc3QpOiBIdHRwUGFyYW1zIHtcblxuICAgIHJldHVybiBuZXcgSHR0cFBhcmFtcygpXG4gICAgICAuc2V0KCdvZmZzZXQnLCAnJyArIHJlcXVlc3Qub2Zmc2V0KVxuICAgICAgLnNldCgnbGltaXQnLCAnJyArIHJlcXVlc3QubGltaXQpXG4gICAgICAuc2V0KCdoYXRlb2FzTW9kZScsICdmYWxzZScpO1xuICB9XG5cbiAgcHJpdmF0ZSBzdGF0aWMgdG9Mb2NhdGlvblN0cmluZyhuZWFyTG9jYXRpb246IE5lYXJMb2NhdGlvblJlcXVlc3QpOiBzdHJpbmcge1xuXG4gICAgbGV0IGxvY2F0aW9uU3RyaW5nID0gJyc7XG5cbiAgICBpZiAobmVhckxvY2F0aW9uLmxhdGl0dWRlID4gMCkge1xuICAgICAgbG9jYXRpb25TdHJpbmcgKz0gJysnO1xuICAgIH1cblxuICAgIGxvY2F0aW9uU3RyaW5nICs9IG5lYXJMb2NhdGlvbi5sYXRpdHVkZTtcblxuICAgIGlmIChuZWFyTG9jYXRpb24ubG9uZ2l0dWRlID4gMCkge1xuICAgICAgbG9jYXRpb25TdHJpbmcgKz0gJysnO1xuICAgIH1cblxuICAgIGxvY2F0aW9uU3RyaW5nICs9IG5lYXJMb2NhdGlvbi5sb25naXR1ZGU7XG5cbiAgICByZXR1cm4gbG9jYXRpb25TdHJpbmc7XG4gIH1cblxuICBmaW5kQWRtaW5EaXZpc2lvbnMocmVxdWVzdDogRmluZEFkbWluRGl2aXNpb25zUmVxdWVzdCk6IE9ic2VydmFibGU8R2VvUmVzcG9uc2U8UGxhY2VTdW1tYXJ5W10+PiB7XG5cbiAgICBsZXQgcGFyYW1zOiBIdHRwUGFyYW1zID0gR2VvRGJTZXJ2aWNlLmJ1aWxkUGFnaW5nUGFyYW1zKHJlcXVlc3QpO1xuXG4gICAgaWYgKHJlcXVlc3QuY291bnRyeUlkcykge1xuICAgICAgcGFyYW1zID0gcGFyYW1zLnNldCgnY291bnRyeUlkcycsIHJlcXVlc3QuY291bnRyeUlkcy5qb2luKCcsJykpO1xuICAgIH1cblxuICAgIGlmIChyZXF1ZXN0LmV4Y2x1ZGVkQ291bnRyeUlkcykge1xuICAgICAgcGFyYW1zID0gcGFyYW1zLnNldCgnZXhjbHVkZWRDb3VudHJ5SWRzJywgcmVxdWVzdC5leGNsdWRlZENvdW50cnlJZHMuam9pbignLCcpKTtcbiAgICB9XG5cbiAgICBpZiAocmVxdWVzdC5uYW1lUHJlZml4KSB7XG4gICAgICBwYXJhbXMgPSBwYXJhbXMuc2V0KCduYW1lUHJlZml4JywgcmVxdWVzdC5uYW1lUHJlZml4KTtcbiAgICB9XG5cbiAgICBpZiAocmVxdWVzdC5taW5Qb3B1bGF0aW9uKSB7XG4gICAgICBwYXJhbXMgPSBwYXJhbXMuc2V0KCdtaW5Qb3B1bGF0aW9uJywgJycgKyByZXF1ZXN0Lm1pblBvcHVsYXRpb24pO1xuICAgIH1cblxuICAgIGlmIChyZXF1ZXN0LnRpbWVab25lSWRzKSB7XG4gICAgICBwYXJhbXMgPSBwYXJhbXMuc2V0KCd0aW1lWm9uZUlkcycsIHJlcXVlc3QudGltZVpvbmVJZHMuam9pbignLCcpKTtcbiAgICB9XG5cbiAgICBpZiAocmVxdWVzdC5hc2NpaU1vZGUpIHtcbiAgICAgIHBhcmFtcyA9IHBhcmFtcy5zZXQoJ2FzY2lpTW9kZScsICcnICsgcmVxdWVzdC5hc2NpaU1vZGUpO1xuICAgIH1cblxuICAgIGlmIChyZXF1ZXN0Lmxhbmd1YWdlQ29kZSkge1xuICAgICAgcGFyYW1zID0gcGFyYW1zLnNldCgnbGFuZ3VhZ2VDb2RlJywgcmVxdWVzdC5sYW5ndWFnZUNvZGUpO1xuICAgIH1cblxuICAgIGlmIChyZXF1ZXN0LnNvcnREaXJlY3RpdmVzKSB7XG4gICAgICBwYXJhbXMgPSBwYXJhbXMuc2V0KCdzb3J0JywgcmVxdWVzdC5zb3J0RGlyZWN0aXZlcy5qb2luKCcsJykpO1xuICAgIH1cblxuICAgIGlmIChyZXF1ZXN0LmluY2x1ZGVEZWxldGVkKSB7XG4gICAgICBwYXJhbXMgPSBwYXJhbXMuc2V0KCdpbmNsdWRlRGVsZXRlZCcsIHJlcXVlc3QuaW5jbHVkZURlbGV0ZWQpO1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzLmh0dHBDbGllbnQuZ2V0PEdlb1Jlc3BvbnNlPFBsYWNlU3VtbWFyeVtdPj4oXG4gICAgICB0aGlzLmFkbWluRGl2aXNpb25zRW5kcG9pbnQsXG4gICAgICB7XG4gICAgICAgIHBhcmFtczogcGFyYW1zXG4gICAgICB9XG4gICAgKTtcbiAgfVxuXG4gIGZpbmRQbGFjZShyZXF1ZXN0OiBHZXRQbGFjZURldGFpbHNSZXF1ZXN0KTogT2JzZXJ2YWJsZTxHZW9SZXNwb25zZTxQbGFjZURldGFpbHM+PiB7XG5cbiAgICBjb25zdCBlbmRwb2ludCA9IHRoaXMuYnVpbGRQbGFjZUVuZHBvaW50KHJlcXVlc3QucGxhY2VJZCk7XG5cbiAgICBsZXQgcGFyYW1zOiBIdHRwUGFyYW1zID0gbmV3IEh0dHBQYXJhbXMoKTtcblxuICAgIGlmIChyZXF1ZXN0LmFzY2lpTW9kZSkge1xuICAgICAgcGFyYW1zID0gcGFyYW1zLnNldCgnYXNjaWlNb2RlJywgJycgKyByZXF1ZXN0LmFzY2lpTW9kZSk7XG4gICAgfVxuXG4gICAgaWYgKHJlcXVlc3QubGFuZ3VhZ2VDb2RlKSB7XG4gICAgICBwYXJhbXMgPSBwYXJhbXMuc2V0KCdsYW5ndWFnZUNvZGUnLCByZXF1ZXN0Lmxhbmd1YWdlQ29kZSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXMuaHR0cENsaWVudC5nZXQ8R2VvUmVzcG9uc2U8UGxhY2VEZXRhaWxzPj4oXG4gICAgICBlbmRwb2ludCxcbiAgICAgIHtcbiAgICAgICAgcGFyYW1zOiBwYXJhbXNcbiAgICAgIH1cbiAgICApO1xuICB9XG5cbiAgZmluZFBsYWNlcyhyZXF1ZXN0OiBGaW5kUGxhY2VzUmVxdWVzdCk6IE9ic2VydmFibGU8R2VvUmVzcG9uc2U8UGxhY2VTdW1tYXJ5W10+PiB7XG5cbiAgICBsZXQgcGFyYW1zOiBIdHRwUGFyYW1zID0gR2VvRGJTZXJ2aWNlLmJ1aWxkUGFnaW5nUGFyYW1zKHJlcXVlc3QpO1xuXG4gICAgaWYgKHJlcXVlc3QuY291bnRyeUlkcykge1xuICAgICAgcGFyYW1zID0gcGFyYW1zLnNldCgnY291bnRyeUlkcycsIHJlcXVlc3QuY291bnRyeUlkcy5qb2luKCcsJykpO1xuICAgIH1cblxuICAgIGlmIChyZXF1ZXN0LmV4Y2x1ZGVkQ291bnRyeUlkcykge1xuICAgICAgcGFyYW1zID0gcGFyYW1zLnNldCgnZXhjbHVkZWRDb3VudHJ5SWRzJywgcmVxdWVzdC5leGNsdWRlZENvdW50cnlJZHMuam9pbignLCcpKTtcbiAgICB9XG5cbiAgICBpZiAocmVxdWVzdC5uYW1lUHJlZml4KSB7XG4gICAgICBwYXJhbXMgPSBwYXJhbXMuc2V0KCduYW1lUHJlZml4JywgcmVxdWVzdC5uYW1lUHJlZml4KTtcbiAgICB9XG5cbiAgICBpZiAocmVxdWVzdC5taW5Qb3B1bGF0aW9uKSB7XG4gICAgICBwYXJhbXMgPSBwYXJhbXMuc2V0KCdtaW5Qb3B1bGF0aW9uJywgJycgKyByZXF1ZXN0Lm1pblBvcHVsYXRpb24pO1xuICAgIH1cblxuICAgIGlmIChyZXF1ZXN0LnRpbWVab25lSWRzKSB7XG4gICAgICBwYXJhbXMgPSBwYXJhbXMuc2V0KCd0aW1lWm9uZUlkcycsIHJlcXVlc3QudGltZVpvbmVJZHMuam9pbignLCcpKTtcbiAgICB9XG5cbiAgICBpZiAocmVxdWVzdC50eXBlcykge1xuICAgICAgcGFyYW1zID0gcGFyYW1zLnNldCgndHlwZXMnLCByZXF1ZXN0LnR5cGVzLmpvaW4oJywnKSk7XG4gICAgfVxuXG4gICAgaWYgKHJlcXVlc3QuYXNjaWlNb2RlKSB7XG4gICAgICBwYXJhbXMgPSBwYXJhbXMuc2V0KCdhc2NpaU1vZGUnLCAnJyArIHJlcXVlc3QuYXNjaWlNb2RlKTtcbiAgICB9XG5cbiAgICBpZiAocmVxdWVzdC5sYW5ndWFnZUNvZGUpIHtcbiAgICAgIHBhcmFtcyA9IHBhcmFtcy5zZXQoJ2xhbmd1YWdlQ29kZScsIHJlcXVlc3QubGFuZ3VhZ2VDb2RlKTtcbiAgICB9XG5cbiAgICBpZiAocmVxdWVzdC5zb3J0RGlyZWN0aXZlcykge1xuICAgICAgcGFyYW1zID0gcGFyYW1zLnNldCgnc29ydCcsIHJlcXVlc3Quc29ydERpcmVjdGl2ZXMuam9pbignLCcpKTtcbiAgICB9XG5cbiAgICBpZiAocmVxdWVzdC5pbmNsdWRlRGVsZXRlZCkge1xuICAgICAgcGFyYW1zID0gcGFyYW1zLnNldCgnaW5jbHVkZURlbGV0ZWQnLCByZXF1ZXN0LmluY2x1ZGVEZWxldGVkKTtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcy5odHRwQ2xpZW50LmdldDxHZW9SZXNwb25zZTxQbGFjZVN1bW1hcnlbXT4+KFxuICAgICAgdGhpcy5wbGFjZXNFbmRwb2ludCxcbiAgICAgIHtcbiAgICAgICAgcGFyYW1zOiBwYXJhbXNcbiAgICAgIH1cbiAgICApO1xuICB9XG5cbiAgZmluZFBsYWNlc05lYXJMb2NhdGlvbihyZXF1ZXN0OiBGaW5kUGxhY2VzTmVhckxvY2F0aW9uUmVxdWVzdCk6IE9ic2VydmFibGU8R2VvUmVzcG9uc2U8UGxhY2VTdW1tYXJ5W10+PiB7XG5cbiAgICBsZXQgcGFyYW1zOiBIdHRwUGFyYW1zID0gR2VvRGJTZXJ2aWNlLmJ1aWxkUGFnaW5nUGFyYW1zKHJlcXVlc3QpO1xuXG4gICAgcGFyYW1zID0gcGFyYW1zXG4gICAgICAuc2V0KCdyYWRpdXMnLCAnJyArIHJlcXVlc3QubG9jYXRpb24ucmFkaXVzKVxuICAgICAgLnNldCgnZGlzdGFuY2VVbml0JywgcmVxdWVzdC5sb2NhdGlvbi5kaXN0YW5jZVVuaXQpO1xuXG4gICAgaWYgKHJlcXVlc3QubWluUG9wdWxhdGlvbikge1xuICAgICAgcGFyYW1zID0gcGFyYW1zLnNldCgnbWluUG9wdWxhdGlvbicsICcnICsgcmVxdWVzdC5taW5Qb3B1bGF0aW9uKTtcbiAgICB9XG5cbiAgICBpZiAocmVxdWVzdC5uYW1lUHJlZml4KSB7XG4gICAgICBwYXJhbXMgPSBwYXJhbXMuc2V0KCduYW1lUHJlZml4JywgcmVxdWVzdC5uYW1lUHJlZml4KTtcbiAgICB9XG5cbiAgICBpZiAocmVxdWVzdC50eXBlcykge1xuICAgICAgcGFyYW1zID0gcGFyYW1zLnNldCgndHlwZXMnLCByZXF1ZXN0LnR5cGVzLmpvaW4oJywnKSk7XG4gICAgfVxuXG4gICAgaWYgKHJlcXVlc3QuYXNjaWlNb2RlKSB7XG4gICAgICBwYXJhbXMgPSBwYXJhbXMuc2V0KCdhc2NpaU1vZGUnLCAnJyArIHJlcXVlc3QuYXNjaWlNb2RlKTtcbiAgICB9XG5cbiAgICBpZiAocmVxdWVzdC5sYW5ndWFnZUNvZGUpIHtcbiAgICAgIHBhcmFtcyA9IHBhcmFtcy5zZXQoJ2xhbmd1YWdlQ29kZScsIHJlcXVlc3QubGFuZ3VhZ2VDb2RlKTtcbiAgICB9XG5cbiAgICBpZiAocmVxdWVzdC5zb3J0RGlyZWN0aXZlcykge1xuICAgICAgcGFyYW1zID0gcGFyYW1zLnNldCgnc29ydCcsIHJlcXVlc3Quc29ydERpcmVjdGl2ZXMuam9pbignLCcpKTtcbiAgICB9XG5cbiAgICBpZiAocmVxdWVzdC5pbmNsdWRlRGVsZXRlZCkge1xuICAgICAgcGFyYW1zID0gcGFyYW1zLnNldCgnaW5jbHVkZURlbGV0ZWQnLCByZXF1ZXN0LmluY2x1ZGVEZWxldGVkKTtcbiAgICB9XG5cbiAgICAvLyBXb3JrYXJvdW5kIGZvciBIdHRwQ2xpZW50ICcrJyBlbmNvZGluZyBidWcuXG4gICAgY29uc3QgbG9jYXRpb25JZCA9IEdlb0RiU2VydmljZVxuICAgICAgLnRvTG9jYXRpb25TdHJpbmcocmVxdWVzdC5sb2NhdGlvbilcbiAgICAgIC5yZXBsYWNlKCcrJywgJyUyQicpO1xuXG4gICAgY29uc3QgZW5kcG9pbnQgPSB0aGlzLnBsYWNlc0VuZHBvaW50ICsgJz9sb2NhdGlvbj0nICsgbG9jYXRpb25JZDtcblxuICAgIHJldHVybiB0aGlzLmh0dHBDbGllbnQuZ2V0PEdlb1Jlc3BvbnNlPFBsYWNlU3VtbWFyeVtdPj4oXG4gICAgICBlbmRwb2ludCxcbiAgICAgIHtcbiAgICAgICAgcGFyYW1zOiBwYXJhbXNcbiAgICAgIH1cbiAgICApO1xuICB9XG5cbiAgZmluZFBsYWNlc05lYXJQbGFjZShyZXF1ZXN0OiBGaW5kUGxhY2VzTmVhclBsYWNlUmVxdWVzdCk6IE9ic2VydmFibGU8R2VvUmVzcG9uc2U8UGxhY2VTdW1tYXJ5W10+PiB7XG5cbiAgICBsZXQgcGFyYW1zOiBIdHRwUGFyYW1zID0gR2VvRGJTZXJ2aWNlLmJ1aWxkUGFnaW5nUGFyYW1zKHJlcXVlc3QpO1xuXG4gICAgcGFyYW1zID0gcGFyYW1zXG4gICAgICAuc2V0KCdyYWRpdXMnLCAnJyArIHJlcXVlc3QucmFkaXVzKVxuICAgICAgLnNldCgnZGlzdGFuY2VVbml0JywgcmVxdWVzdC5kaXN0YW5jZVVuaXQpO1xuXG4gICAgaWYgKHJlcXVlc3QubWluUG9wdWxhdGlvbikge1xuICAgICAgcGFyYW1zID0gcGFyYW1zLnNldCgnbWluUG9wdWxhdGlvbicsICcnICsgcmVxdWVzdC5taW5Qb3B1bGF0aW9uKTtcbiAgICB9XG5cbiAgICBpZiAocmVxdWVzdC50eXBlcykge1xuICAgICAgcGFyYW1zID0gcGFyYW1zLnNldCgndHlwZXMnLCByZXF1ZXN0LnR5cGVzLmpvaW4oJywnKSk7XG4gICAgfVxuXG4gICAgaWYgKHJlcXVlc3QuYXNjaWlNb2RlKSB7XG4gICAgICBwYXJhbXMgPSBwYXJhbXMuc2V0KCdhc2NpaU1vZGUnLCAnJyArIHJlcXVlc3QuYXNjaWlNb2RlKTtcbiAgICB9XG5cbiAgICBpZiAocmVxdWVzdC5sYW5ndWFnZUNvZGUpIHtcbiAgICAgIHBhcmFtcyA9IHBhcmFtcy5zZXQoJ2xhbmd1YWdlQ29kZScsIHJlcXVlc3QubGFuZ3VhZ2VDb2RlKTtcbiAgICB9XG5cbiAgICBpZiAocmVxdWVzdC5zb3J0RGlyZWN0aXZlcykge1xuICAgICAgcGFyYW1zID0gcGFyYW1zLnNldCgnc29ydCcsIHJlcXVlc3Quc29ydERpcmVjdGl2ZXMuam9pbignLCcpKTtcbiAgICB9XG5cbiAgICBpZiAocmVxdWVzdC5pbmNsdWRlRGVsZXRlZCkge1xuICAgICAgcGFyYW1zID0gcGFyYW1zLnNldCgnaW5jbHVkZURlbGV0ZWQnLCByZXF1ZXN0LmluY2x1ZGVEZWxldGVkKTtcbiAgICB9XG5cbiAgICBjb25zdCBlbmRwb2ludCA9IHRoaXMucGxhY2VzRW5kcG9pbnQgKyAnLycgKyByZXF1ZXN0LnBsYWNlSWQgKyAnL25lYXJieUNpdGllcyc7XG5cbiAgICByZXR1cm4gdGhpcy5odHRwQ2xpZW50LmdldDxHZW9SZXNwb25zZTxQbGFjZVN1bW1hcnlbXT4+KFxuICAgICAgZW5kcG9pbnQsXG4gICAgICB7XG4gICAgICAgIHBhcmFtczogcGFyYW1zXG4gICAgICB9XG4gICAgKTtcbiAgfVxuXG4gIGZpbmRDb3VudHJpZXMocmVxdWVzdDogRmluZENvdW50cmllc1JlcXVlc3QpOiBPYnNlcnZhYmxlPEdlb1Jlc3BvbnNlPENvdW50cnlTdW1tYXJ5W10+PiB7XG5cbiAgICBsZXQgcGFyYW1zOiBIdHRwUGFyYW1zID0gR2VvRGJTZXJ2aWNlLmJ1aWxkUGFnaW5nUGFyYW1zKHJlcXVlc3QpO1xuXG4gICAgaWYgKHJlcXVlc3QuY3VycmVuY3lDb2RlKSB7XG4gICAgICBwYXJhbXMgPSBwYXJhbXMuc2V0KCdjdXJyZW5jeUNvZGUnLCByZXF1ZXN0LmN1cnJlbmN5Q29kZSk7XG4gICAgfVxuXG4gICAgaWYgKHJlcXVlc3QubmFtZVByZWZpeCkge1xuICAgICAgcGFyYW1zID0gcGFyYW1zLnNldCgnbmFtZVByZWZpeCcsIHJlcXVlc3QubmFtZVByZWZpeCk7XG4gICAgfVxuXG4gICAgaWYgKHJlcXVlc3QuYXNjaWlNb2RlKSB7XG4gICAgICBwYXJhbXMgPSBwYXJhbXMuc2V0KCdhc2NpaU1vZGUnLCAnJyArIHJlcXVlc3QuYXNjaWlNb2RlKTtcbiAgICB9XG5cbiAgICBpZiAocmVxdWVzdC5sYW5ndWFnZUNvZGUpIHtcbiAgICAgIHBhcmFtcyA9IHBhcmFtcy5zZXQoJ2xhbmd1YWdlQ29kZScsIHJlcXVlc3QubGFuZ3VhZ2VDb2RlKTtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcy5odHRwQ2xpZW50LmdldDxHZW9SZXNwb25zZTxDb3VudHJ5U3VtbWFyeVtdPj4oXG4gICAgICB0aGlzLmNvdW50cmllc0VuZHBvaW50LFxuICAgICAge1xuICAgICAgICBwYXJhbXM6IHBhcmFtc1xuICAgICAgfVxuICAgICk7XG4gIH1cblxuICBmaW5kQ291bnRyeShyZXF1ZXN0OiBHZXRDb3VudHJ5RGV0YWlsc1JlcXVlc3QpOiBPYnNlcnZhYmxlPEdlb1Jlc3BvbnNlPENvdW50cnlEZXRhaWxzPj4ge1xuXG4gICAgY29uc3QgZW5kcG9pbnQgPSB0aGlzLmNvdW50cmllc0VuZHBvaW50ICsgJy8nICsgcmVxdWVzdC5jb3VudHJ5SWQ7XG5cbiAgICBsZXQgcGFyYW1zOiBIdHRwUGFyYW1zID0gbmV3IEh0dHBQYXJhbXMoKTtcblxuICAgIGlmIChyZXF1ZXN0LmFzY2lpTW9kZSkge1xuICAgICAgcGFyYW1zID0gcGFyYW1zLnNldCgnYXNjaWlNb2RlJywgJycgKyByZXF1ZXN0LmFzY2lpTW9kZSk7XG4gICAgfVxuXG4gICAgaWYgKHJlcXVlc3QubGFuZ3VhZ2VDb2RlKSB7XG4gICAgICBwYXJhbXMgPSBwYXJhbXMuc2V0KCdsYW5ndWFnZUNvZGUnLCByZXF1ZXN0Lmxhbmd1YWdlQ29kZSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXMuaHR0cENsaWVudC5nZXQ8R2VvUmVzcG9uc2U8Q291bnRyeURldGFpbHM+PihcbiAgICAgIGVuZHBvaW50LFxuICAgICAge1xuICAgICAgICBwYXJhbXM6IHBhcmFtc1xuICAgICAgfSk7XG4gIH1cblxuICBmaW5kQ3VycmVuY2llcyhyZXF1ZXN0OiBGaW5kQ3VycmVuY2llc1JlcXVlc3QpOiBPYnNlcnZhYmxlPEdlb1Jlc3BvbnNlPEN1cnJlbmN5W10+PiB7XG5cbiAgICBsZXQgcGFyYW1zOiBIdHRwUGFyYW1zID0gR2VvRGJTZXJ2aWNlLmJ1aWxkUGFnaW5nUGFyYW1zKHJlcXVlc3QpO1xuXG4gICAgaWYgKHJlcXVlc3QuY291bnRyeUlkKSB7XG4gICAgICBwYXJhbXMgPSBwYXJhbXMuc2V0KCdjb3VudHJ5SWQnLCByZXF1ZXN0LmNvdW50cnlJZCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXMuaHR0cENsaWVudC5nZXQ8R2VvUmVzcG9uc2U8Q3VycmVuY3lbXT4+KFxuICAgICAgdGhpcy5jdXJyZW5jaWVzRW5kcG9pbnQsXG4gICAgICB7XG4gICAgICAgIHBhcmFtczogcGFyYW1zXG4gICAgICB9XG4gICAgKTtcbiAgfVxuXG4gIGZpbmRMYW5ndWFnZXMocmVxdWVzdDogRmluZENvbGxlY3Rpb25SZXF1ZXN0KTogT2JzZXJ2YWJsZTxHZW9SZXNwb25zZTxMYW5ndWFnZVtdPj4ge1xuXG4gICAgY29uc3QgcGFyYW1zOiBIdHRwUGFyYW1zID0gR2VvRGJTZXJ2aWNlLmJ1aWxkUGFnaW5nUGFyYW1zKHJlcXVlc3QpO1xuXG4gICAgcmV0dXJuIHRoaXMuaHR0cENsaWVudC5nZXQ8R2VvUmVzcG9uc2U8TG9jYWxlW10+PihcbiAgICAgIHRoaXMubGFuZ3VhZ2VzRW5kcG9pbnQsXG4gICAgICB7XG4gICAgICAgIHBhcmFtczogcGFyYW1zXG4gICAgICB9XG4gICAgKTtcbiAgfVxuXG4gIGZpbmRMb2NhbGVzKHJlcXVlc3Q6IEZpbmRDb2xsZWN0aW9uUmVxdWVzdCk6IE9ic2VydmFibGU8R2VvUmVzcG9uc2U8TG9jYWxlW10+PiB7XG5cbiAgICBjb25zdCBwYXJhbXM6IEh0dHBQYXJhbXMgPSBHZW9EYlNlcnZpY2UuYnVpbGRQYWdpbmdQYXJhbXMocmVxdWVzdCk7XG5cbiAgICByZXR1cm4gdGhpcy5odHRwQ2xpZW50LmdldDxHZW9SZXNwb25zZTxMb2NhbGVbXT4+KFxuICAgICAgdGhpcy5sb2NhbGVzRW5kcG9pbnQsXG4gICAgICB7XG4gICAgICAgIHBhcmFtczogcGFyYW1zXG4gICAgICB9XG4gICAgKTtcbiAgfVxuXG4gIGZpbmRSZWdpb24ocmVxdWVzdDogR2V0UmVnaW9uRGV0YWlsc1JlcXVlc3QpOiBPYnNlcnZhYmxlPEdlb1Jlc3BvbnNlPFJlZ2lvbkRldGFpbHM+PiB7XG5cbiAgICBjb25zdCBlbmRwb2ludCA9IHRoaXMuYnVpbGRSZWdpb25zRW5kcG9pbnQocmVxdWVzdC5jb3VudHJ5SWQpICsgJy8nICsgcmVxdWVzdC5yZWdpb25Db2RlO1xuXG4gICAgbGV0IHBhcmFtczogSHR0cFBhcmFtcyA9IG5ldyBIdHRwUGFyYW1zKCk7XG5cbiAgICBpZiAocmVxdWVzdC5hc2NpaU1vZGUpIHtcbiAgICAgIHBhcmFtcyA9IHBhcmFtcy5zZXQoJ2FzY2lpTW9kZScsICcnICsgcmVxdWVzdC5hc2NpaU1vZGUpO1xuICAgIH1cblxuICAgIGlmIChyZXF1ZXN0Lmxhbmd1YWdlQ29kZSkge1xuICAgICAgcGFyYW1zID0gcGFyYW1zLnNldCgnbGFuZ3VhZ2VDb2RlJywgcmVxdWVzdC5sYW5ndWFnZUNvZGUpO1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzLmh0dHBDbGllbnQuZ2V0PEdlb1Jlc3BvbnNlPFJlZ2lvbkRldGFpbHM+PihcbiAgICAgIGVuZHBvaW50LFxuICAgICAge1xuICAgICAgICBwYXJhbXM6IHBhcmFtc1xuICAgICAgfSk7XG4gIH1cblxuICBmaW5kUmVnaW9uUGxhY2VzKHJlcXVlc3Q6IEZpbmRSZWdpb25DaXRpZXNSZXF1ZXN0KTogT2JzZXJ2YWJsZTxHZW9SZXNwb25zZTxQbGFjZVN1bW1hcnlbXT4+IHtcblxuICAgIGNvbnN0IGVuZHBvaW50ID0gdGhpcy5idWlsZFJlZ2lvbkVuZHBvaW50KHJlcXVlc3QuY291bnRyeUlkLCByZXF1ZXN0LnJlZ2lvbkNvZGUpICsgJy9jaXRpZXMnO1xuXG4gICAgbGV0IHBhcmFtczogSHR0cFBhcmFtcyA9IEdlb0RiU2VydmljZS5idWlsZFBhZ2luZ1BhcmFtcyhyZXF1ZXN0KTtcblxuICAgIGlmIChyZXF1ZXN0Lm1pblBvcHVsYXRpb24pIHtcbiAgICAgIHBhcmFtcyA9IHBhcmFtcy5zZXQoJ21pblBvcHVsYXRpb24nLCAnJyArIHJlcXVlc3QubWluUG9wdWxhdGlvbik7XG4gICAgfVxuXG4gICAgaWYgKHJlcXVlc3QudHlwZXMpIHtcbiAgICAgIHBhcmFtcyA9IHBhcmFtcy5zZXQoJ3R5cGVzJywgcmVxdWVzdC50eXBlcy5qb2luKCcsJykpO1xuICAgIH1cblxuICAgIGlmIChyZXF1ZXN0LmFzY2lpTW9kZSkge1xuICAgICAgcGFyYW1zID0gcGFyYW1zLnNldCgnYXNjaWlNb2RlJywgJycgKyByZXF1ZXN0LmFzY2lpTW9kZSk7XG4gICAgfVxuXG4gICAgaWYgKHJlcXVlc3QubGFuZ3VhZ2VDb2RlKSB7XG4gICAgICBwYXJhbXMgPSBwYXJhbXMuc2V0KCdsYW5ndWFnZUNvZGUnLCByZXF1ZXN0Lmxhbmd1YWdlQ29kZSk7XG4gICAgfVxuXG4gICAgaWYgKHJlcXVlc3Quc29ydERpcmVjdGl2ZXMpIHtcbiAgICAgIHBhcmFtcyA9IHBhcmFtcy5zZXQoJ3NvcnQnLCByZXF1ZXN0LnNvcnREaXJlY3RpdmVzLmpvaW4oJywnKSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHRoaXMuaHR0cENsaWVudC5nZXQ8R2VvUmVzcG9uc2U8UGxhY2VTdW1tYXJ5W10+PihcbiAgICAgIGVuZHBvaW50LFxuICAgICAge1xuICAgICAgICBwYXJhbXM6IHBhcmFtc1xuICAgICAgfVxuICAgICk7XG4gIH1cblxuICBmaW5kUmVnaW9ucyhyZXF1ZXN0OiBGaW5kUmVnaW9uc1JlcXVlc3QpOiBPYnNlcnZhYmxlPEdlb1Jlc3BvbnNlPFJlZ2lvblN1bW1hcnlbXT4+IHtcblxuICAgIGNvbnN0IGVuZHBvaW50ID0gdGhpcy5idWlsZFJlZ2lvbnNFbmRwb2ludChyZXF1ZXN0LmNvdW50cnlJZCk7XG5cbiAgICBsZXQgcGFyYW1zOiBIdHRwUGFyYW1zID0gR2VvRGJTZXJ2aWNlLmJ1aWxkUGFnaW5nUGFyYW1zKHJlcXVlc3QpO1xuXG4gICAgaWYgKHJlcXVlc3QubmFtZVByZWZpeCkge1xuICAgICAgICBwYXJhbXMgPSBwYXJhbXMuc2V0KCduYW1lUHJlZml4JywgcmVxdWVzdC5uYW1lUHJlZml4KTtcbiAgICB9XG5cbiAgICBpZiAocmVxdWVzdC5hc2NpaU1vZGUpIHtcbiAgICAgIHBhcmFtcyA9IHBhcmFtcy5zZXQoJ2FzY2lpTW9kZScsICcnICsgcmVxdWVzdC5hc2NpaU1vZGUpO1xuICAgIH1cblxuICAgIGlmIChyZXF1ZXN0Lmxhbmd1YWdlQ29kZSkge1xuICAgICAgcGFyYW1zID0gcGFyYW1zLnNldCgnbGFuZ3VhZ2VDb2RlJywgcmVxdWVzdC5sYW5ndWFnZUNvZGUpO1xuICAgIH1cblxuICAgIHJldHVybiB0aGlzLmh0dHBDbGllbnQuZ2V0PEdlb1Jlc3BvbnNlPFJlZ2lvblN1bW1hcnlbXT4+KFxuICAgICAgZW5kcG9pbnQsXG4gICAgICB7XG4gICAgICAgIHBhcmFtczogcGFyYW1zXG4gICAgICB9XG4gICAgKTtcbiAgfVxuXG4gIGZpbmRUaW1lWm9uZXMocmVxdWVzdDogRmluZENvbGxlY3Rpb25SZXF1ZXN0KTogT2JzZXJ2YWJsZTxHZW9SZXNwb25zZTxUaW1lWm9uZVtdPj4ge1xuXG4gICAgY29uc3QgcGFyYW1zOiBIdHRwUGFyYW1zID0gR2VvRGJTZXJ2aWNlLmJ1aWxkUGFnaW5nUGFyYW1zKHJlcXVlc3QpO1xuXG4gICAgcmV0dXJuIHRoaXMuaHR0cENsaWVudC5nZXQ8R2VvUmVzcG9uc2U8VGltZVpvbmVbXT4+KFxuICAgICAgdGhpcy50aW1lWm9uZXNFbmRwb2ludCxcbiAgICAgIHtcbiAgICAgICAgcGFyYW1zOiBwYXJhbXNcbiAgICAgIH1cbiAgICApO1xuICB9XG5cbiAgZ2V0IGFwaUtleSgpOiBzdHJpbmcge1xuICAgIHJldHVybiB0aGlzLmNvbmZpZy5hcGlLZXk7XG4gIH1cblxuICBzZXRBcGlLZXkoYXBpS2V5OiBzdHJpbmcpIHtcbiAgICB0aGlzLmNvbmZpZy5hcGlLZXkgPSBhcGlLZXk7XG4gIH1cblxuICBnZXRQbGFjZURhdGVUaW1lKGlkOiBzdHJpbmcpOiBPYnNlcnZhYmxlPEdlb1Jlc3BvbnNlPHN0cmluZz4+IHtcblxuICAgIGNvbnN0IGVuZHBvaW50ID0gdGhpcy5idWlsZFBsYWNlRW5kcG9pbnQoaWQpICsgJy9kYXRlVGltZSc7XG5cbiAgICByZXR1cm4gdGhpcy5odHRwQ2xpZW50LmdldDxHZW9SZXNwb25zZTxzdHJpbmc+PihlbmRwb2ludCk7XG4gIH1cblxuICBnZXRQbGFjZURpc3RhbmNlKHJlcXVlc3Q6IEdldFBsYWNlRGlzdGFuY2VSZXF1ZXN0KTogT2JzZXJ2YWJsZTxHZW9SZXNwb25zZTxudW1iZXI+PiB7XG5cbiAgICBjb25zdCBlbmRwb2ludCA9IHRoaXMuYnVpbGRQbGFjZUVuZHBvaW50KHJlcXVlc3QudG9QbGFjZUlkKSArICcvZGlzdGFuY2UnO1xuXG4gICAgY29uc3QgcGFyYW1zOiBIdHRwUGFyYW1zID0gbmV3IEh0dHBQYXJhbXMoKVxuICAgICAgLnNldCgnZnJvbVBsYWNlSWQnLCAnJyArIHJlcXVlc3QuZnJvbVBsYWNlSWQpXG4gICAgICAuc2V0KCdkaXN0YW5jZVVuaXQnLCAnJyArIHJlcXVlc3QuZGlzdGFuY2VVbml0KTtcblxuICAgIHJldHVybiB0aGlzLmh0dHBDbGllbnQuZ2V0PEdlb1Jlc3BvbnNlPG51bWJlcj4+KFxuICAgICAgZW5kcG9pbnQsXG4gICAgICB7XG4gICAgICAgIHBhcmFtczogcGFyYW1zXG4gICAgICB9XG4gICAgKTtcbiAgfVxuXG4gIGdldFBsYWNlVGltZShwbGFjZUlkOiBzdHJpbmcpOiBPYnNlcnZhYmxlPEdlb1Jlc3BvbnNlPHN0cmluZz4+IHtcblxuICAgIGNvbnN0IGVuZHBvaW50ID0gdGhpcy5idWlsZFBsYWNlRW5kcG9pbnQocGxhY2VJZCkgKyAnL3RpbWUnO1xuXG4gICAgcmV0dXJuIHRoaXMuaHR0cENsaWVudC5nZXQ8R2VvUmVzcG9uc2U8c3RyaW5nPj4oZW5kcG9pbnQpO1xuICB9XG5cbiAgZ2V0VGltZVpvbmVEYXRlVGltZSh6b25lSWQ6IHN0cmluZyk6IE9ic2VydmFibGU8R2VvUmVzcG9uc2U8c3RyaW5nPj4ge1xuXG4gICAgY29uc3QgZW5kcG9pbnQgPSB0aGlzLmJ1aWxkVGltZVpvbmVFbmRwb2ludCh6b25lSWQpICsgJy9kYXRlVGltZSc7XG5cbiAgICByZXR1cm4gdGhpcy5odHRwQ2xpZW50LmdldDxHZW9SZXNwb25zZTxzdHJpbmc+PihlbmRwb2ludCk7XG4gIH1cblxuICBnZXRUaW1lWm9uZVRpbWUoem9uZUlkOiBzdHJpbmcpOiBPYnNlcnZhYmxlPEdlb1Jlc3BvbnNlPHN0cmluZz4+IHtcblxuICAgIGNvbnN0IGVuZHBvaW50ID0gdGhpcy5idWlsZFRpbWVab25lRW5kcG9pbnQoem9uZUlkKSArICcvdGltZSc7XG5cbiAgICByZXR1cm4gdGhpcy5odHRwQ2xpZW50LmdldDxHZW9SZXNwb25zZTxzdHJpbmc+PihlbmRwb2ludCk7XG4gIH1cblxuICBwcml2YXRlIGJ1aWxkUGxhY2VFbmRwb2ludChvbGFjZUlkOiBzdHJpbmcpOiBzdHJpbmcge1xuICAgIHJldHVybiB0aGlzLnBsYWNlc0VuZHBvaW50ICsgJy8nICsgb2xhY2VJZDtcbiAgfVxuXG4gIHByaXZhdGUgYnVpbGRSZWdpb25FbmRwb2ludChjb3VudHJ5SWQ6IHN0cmluZywgcmVnaW9uQ29kZTogc3RyaW5nKTogc3RyaW5nIHtcbiAgICByZXR1cm4gdGhpcy5idWlsZFJlZ2lvbnNFbmRwb2ludChjb3VudHJ5SWQpICsgJy8nICsgcmVnaW9uQ29kZTtcbiAgfVxuXG4gIHByaXZhdGUgYnVpbGRSZWdpb25zRW5kcG9pbnQoY291bnRyeUlkOiBzdHJpbmcpOiBzdHJpbmcge1xuICAgIHJldHVybiB0aGlzLmNvdW50cmllc0VuZHBvaW50ICsgJy8nICsgY291bnRyeUlkICsgJy9yZWdpb25zJztcbiAgfVxuXG4gIHByaXZhdGUgYnVpbGRUaW1lWm9uZUVuZHBvaW50KHpvbmVJZDogc3RyaW5nKTogc3RyaW5nIHtcbiAgICByZXR1cm4gdGhpcy50aW1lWm9uZXNFbmRwb2ludCArICcvJyArIHpvbmVJZDtcbiAgfVxufVxuIl19